<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>5.2 pisces.asn1 - Encode and decode ASN.1 BER format</title>
<META NAME="description" CONTENT="5.2 pisces.asn1 - Encode and decode ASN.1 BER format">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="manual.css">
<LINK REL="next" href="module-pisces.cryptrand.html">
<LINK REL="previous" href="module-pisces.algid.html">
<LINK REL="up" HREF="node8.html">
<LINK REL="next" href="module-pisces.cryptrand.html">
</head>
<body bgcolor="#ffffff" text="#000000" link="#0000bb"  vlink="#551a8b" alink="#ff0000">
<div class='navigation'>
<table align='center' width='100%' cellpadding='0' cellspacing='2'>
<tr>
<td><A href="module-pisces.cryptrand.html"><img width=32 height=32 align=bottom border=0 alt="next"
 src="next.gif"></A></td>
<td><A HREF="node8.html"><img width=32 height=32 align=bottom border=0 alt="up"
 src="up.gif"></A></td>
<td><A href="module-pisces.algid.html"><img width=32 height=32 align=bottom border=0 alt="previous"
 src="previous.gif"></A></td>
<td align=center bgcolor="#99CCFF" width="100%">
 <b class=title>Pisces User Manual</b></td>
<td><A href="contents.html"><img width=32 height=32 align=bottom border=0 alt="contents"
 src="contents.gif"></A></td>
<td><img width=32 height=32 align=bottom border=0 alt=""
 src="blank.gif"></td>
<td><img width=32 height=32 align=bottom border=0 alt=""
 src="blank.gif"></td>
</tr></table><b class='navlabel'>Next:</b> <span class='sectref'><A href="module-pisces.cryptrand.html">5.3 pisces.cryptrand - Interface</A></span>
<b class='navlabel'>Up:</b> <span class='sectref'><A HREF="node8.html">5. Pisces Library Reference</A></span>
<b class='navlabel'>Previous:</b> <span class='sectref'><A href="module-pisces.algid.html">5.1 pisces.algid - Constants</A></span>
<br><hr></div>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION000620000000000000000">
5.2 <tt class="module">pisces.asn1</tt>
	- Encode and decode ASN.1 BER format</A>
</H2>


<P>
This module provides a parser for ASN.1 objects encoded using
BER.  The parser produces <tt class="class">ASN1Object</tt> instances that can be
converted back to BER encoding using the <tt class="method">encode</tt> method.

<P>
<dl><dt><b><a name='l2h-5'><tt class='function'>parse</tt></a></b> (<var>buf</var>)
<dd>
Parse string <var>buf</var> and return an <tt class="class">ASN1Object</tt> instance that
it encodes.  Raises <tt class="exception">ValueError</tt> if invalid data is passed
to it.  <i>Warning:</i> This code could be more robust; other
exceptions may be raised for particular invalid inputs.
</dl>

<P>
<dl><dt><b><a name='l2h-6'><tt class='class'>ASN1Object</tt></a></b> (<var>val</var>)
<dd>
The <tt class="class">ASN1Object</tt> class is the abstract base class of all the
objects generated by <tt class="function">parse</tt>.  The constructor takes a single
argument <var>val</var>, a parsed ASN.1 object.

<P>
Subclasses of <tt class="class">ASN1Object</tt> define the following method and
attribute: 

<P>
<tt class="member">atomic</tt>: True if the object is atomic; false if it is a
container. 

<P>
<dl><dt><b><a name='l2h-7'><tt class='method'>encode</tt></a></b> (<big>[</big><var>io</var><big>]</big>)
<dd>
Returns a string containing the BER encoding of the ASN.1 object.  If
a file-like object is passed as <var>io</var>, the encoding will be written
to the file instead.
</dl>

<P>
</dl>

<P>
The following subclasses of <tt class="class">ASN1Object</tt> are defined in this
module.  Methods defined only for single subclasses are also described
here.

<P>
<dl><dt><b><a name='l2h-8'><tt class='class'>Sequence</tt></a></b> ()
<dd>
<tt class="class">Sequence</tt> implements the ASN.1 type SEQUENCE, an ordered
collection of one or more types.  Instances can are also Python
sequence objects.
</dl>

<P>
<dl><dt><b><a name='l2h-9'><tt class='class'>Set</tt></a></b> ()
<dd>
<tt class="class">Set</tt> implements the ASN.1 type SET, an unorderd collection of
one or more types.  Instances can are also Python sequence objects,
where the order depends on the specific order of elements in the
original encoding.
</dl>

<P>
<dl><dt><b><a name='l2h-10'><tt class='class'>UTCTime</tt></a></b> ()
<dd>
<tt class="class">UTCTime</tt> implements the standard ASN.1 type for time expressed
in GMT.  The X.509 standards note that UTCTime values shall be expressed
Greenwich Mean Time (Zulu) and shall include seconds (i.e., times are
YYMMDDHHMMSSZ), even where the number of seconds is zero.  Conforming
systems shall interpret the year field (YY) as follows:

<P>
Where YY is greater than or equal to 50, the year shall be inter-
preted as 19YY; and

<P>
Where YY is less than 50, the year shall be interpreted as 20YY.
</dl>

<P>
<tt class="class">UTCTime</tt> instances can be compared to each other and support
ordering in the natural way.

<P>
<dl><dt><b><a name='l2h-11'><tt class='class'>Contextual</tt></a></b> ()
<dd>
<tt class="class">Contextual</tt> is a wrapper for ASN.1 types defined using CHOICE.
For contextual encoding, it isn't possible to tell what the type of
the contained object is without looking at the ASN.1 type declaration.
This module is designed for parsing independently of the type
declaration, which works for every case exception this one.

<P>
In the case of contextual encoding, this object is returned.  When the
decoded structure is actually used, it should be clear whether this
is, e.g., an OPTIONAL integer type, some other tagged, known type, or
an encoded CHOICE.  Clients should call the decode method when the
encoding includes the full DER encoding.  Clients should call choose
when the value doesn't have the appropriate tag/len info.

<P>
<tt class="class">Contextual</tt> has two extra methods:

<P>
<dl><dt><b><a name='l2h-12'><tt class='method'>decode</tt></a></b> ()
<dd>
Return the decoded object.  This method should be called when the
encoding includes the tag and length.
</dl>

<P>
<dl><dt><b><a name='l2h-13'><tt class='method'>choose</tt></a></b> (<var>tag</var>)
<dd>
Return the decoded object, using <var>tag</var> as the ASN.1 tag.  This
method should be called when the containing type declaration uses
CHOICE and the tag is not included in the encoding.
</dl>

<P>
</dl>

<P>
<dl><dt><b><a name='l2h-14'><tt class='class'>Boolean</tt></a></b> ()
<dd>
<tt class="class">Boolean</tt> is the ASN.1 Boolean type.  Instances of this class
implement <tt class="method">__nonzero__</tt>, so they can be used in Python
conditionals. 
</dl>

<P>
<dl><dt><b><a name='l2h-15'><tt class='class'>OID</tt></a></b> ()
<dd>
An ASN.1 Object Identifier.  Can be compared to other <tt class="class">OID</tt>
objects and used as a dictionary key.
</dl>

<P>
Other ASN.1 types are represented using Python's builtin datatypes.
This table summarizes the ASN.1 types supported.

<P>
<table border align="center" style="border-collapse: collapse">
  <thead>
    <tr bgcolor="#99CCFF">
      <th align="left"><b>ASN.1 type</b>&nbsp;</th>
      <th align="left"><b>Python type</b>&nbsp;</th>
    </thead>
  <tbody valign='baseline'>
    <tr><td align="left" valign="baseline">INTEGER</td>
        <td align="left">int</td>
    <tr><td align="left" valign="baseline">BIT_STRING</td>
        <td align="left">string</td>
    <tr><td align="left" valign="baseline">OCTET_STRING</td>
        <td align="left">string</td>
    <tr><td align="left" valign="baseline">NULL</td>
        <td align="left">None</td>
    <tr><td align="left" valign="baseline">PrintableString</td>
        <td align="left">string</td>
    <tr><td align="left" valign="baseline">T61String</td>
        <td align="left">string</td>
    <tr><td align="left" valign="baseline">IA5String</td>
        <td align="left">string</td></tbody>
</table>

<P>
<dl><dt><b><a name='l2h-16'><tt class='function'>display</tt></a></b> (<var>obj</var>)
<dd>
Pretty-print an <tt class="class">ASN1Object</tt> instance.
</dl>

<P>
<dl><dt><b><a name='l2h-17'><tt class='class'>Displayer</tt></a></b> (<big>[</big><var>oids</var><big>]</big>)
<dd>
The <tt class="class">Displayer</tt> class creates pretty-printers for ASN.1 objects
that will print labels for certain well-known oids.  The constructor
argument <var>oids</var> is a mapping from <tt class="class">OID</tt> object to string
names.
</dl>

<P>
<dl><dt><b><a name='l2h-18'><tt class='function'>parseCfg</tt></a></b> (<var>io</var>)
<dd>
Reads a configuration file from <var>io</var>, which must be a file-like
object ready for reading.  Returns a dictionary mapping <tt class="class">OIDs</tt>
to strings that describe the <tt class="class">OIDs</tt>.  This function is provided
for compatibility with Peter Gutmann's <b class="program">dumpasn1</b> program.  An
example of the configuration file is available at
<a class="url" href="http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.cfg">http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.cfg</a>.
</dl>

<P>
<p>
<div class='navigation'><hr><table align='center' width='100%' cellpadding='0' cellspacing='2'>
<tr>
<td><A href="module-pisces.cryptrand.html"><img width=32 height=32 align=bottom border=0 alt="next"
 src="next.gif"></A></td>
<td><A HREF="node8.html"><img width=32 height=32 align=bottom border=0 alt="up"
 src="up.gif"></A></td>
<td><A href="module-pisces.algid.html"><img width=32 height=32 align=bottom border=0 alt="previous"
 src="previous.gif"></A></td>
<td align=center bgcolor="#99CCFF" width="100%">
 <b class=title>Pisces User Manual</b></td>
<td><A href="contents.html"><img width=32 height=32 align=bottom border=0 alt="contents"
 src="contents.gif"></A></td>
<td><img width=32 height=32 align=bottom border=0 alt=""
 src="blank.gif"></td>
<td><img width=32 height=32 align=bottom border=0 alt=""
 src="blank.gif"></td>
</tr></table><b class='navlabel'>Next:</b> <span class='sectref'><A href="module-pisces.cryptrand.html">5.3 pisces.cryptrand - Interface</A></span>
<b class='navlabel'>Up:</b> <span class='sectref'><A HREF="node8.html">5. Pisces Library Reference</A></span>
<b class='navlabel'>Previous:</b> <span class='sectref'><A href="module-pisces.algid.html">5.1 pisces.algid - Constants</A></span>
</div>
<!--End of Navigation Panel-->

</BODY>
</HTML>
