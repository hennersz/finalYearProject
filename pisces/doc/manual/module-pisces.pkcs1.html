<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>5.6 pisces.pkcs1 - A PKCS #1 wrapper for Crypto.PublicKey.RSA keys</title>
<META NAME="description" CONTENT="5.6 pisces.pkcs1 - A PKCS #1 wrapper for Crypto.PublicKey.RSA keys">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="manual.css">
<LINK REL="next" href="module-pisces.pwcrypt.html">
<LINK REL="previous" href="module-pisces.hmac.html">
<LINK REL="up" HREF="node8.html">
<LINK REL="next" href="module-pisces.pwcrypt.html">
</head>
<body bgcolor="#ffffff" text="#000000" link="#0000bb"  vlink="#551a8b" alink="#ff0000">
<div class='navigation'>
<table align='center' width='100%' cellpadding='0' cellspacing='2'>
<tr>
<td><A href="module-pisces.pwcrypt.html"><img width=32 height=32 align=bottom border=0 alt="next"
 src="next.gif"></A></td>
<td><A HREF="node8.html"><img width=32 height=32 align=bottom border=0 alt="up"
 src="up.gif"></A></td>
<td><A href="module-pisces.hmac.html"><img width=32 height=32 align=bottom border=0 alt="previous"
 src="previous.gif"></A></td>
<td align=center bgcolor="#99CCFF" width="100%">
 <b class=title>Pisces User Manual</b></td>
<td><A href="contents.html"><img width=32 height=32 align=bottom border=0 alt="contents"
 src="contents.gif"></A></td>
<td><img width=32 height=32 align=bottom border=0 alt=""
 src="blank.gif"></td>
<td><img width=32 height=32 align=bottom border=0 alt=""
 src="blank.gif"></td>
</tr></table><b class='navlabel'>Next:</b> <span class='sectref'><A href="module-pisces.pwcrypt.html">5.7 pisces.pwcrypt - Support</A></span>
<b class='navlabel'>Up:</b> <span class='sectref'><A HREF="node8.html">5. Pisces Library Reference</A></span>
<b class='navlabel'>Previous:</b> <span class='sectref'><A href="module-pisces.hmac.html">5.5 pisces.hmac - Keyed-hashing</A></span>
<br><hr></div>
<!--End of Navigation Panel-->

<H2><A NAME="SECTION000660000000000000000">
5.6 <tt class="module">pisces.pkcs1</tt> 
	- A PKCS #1 wrapper for Crypto.PublicKey.RSA keys</A>
</H2>


<P>
This module implements that PKCS #1 RSA encryption standard.  It must
be used in conjunction with <tt class="module">Crypto.PublicKey.RSA</tt>, which
provides the cryptographic primitives.

<P>
The PKCS #1 standard is available from RSA Labs.  As of April 10, 2000
the url is <a class="url" href="http://www.rsasecurity.com/rsalabs/pkcs/pkcs-1/">http://www.rsasecurity.com/rsalabs/pkcs/pkcs-1/</a>.

<P>
This module defines several classes.  The primary interfaces are the
<tt class="class">RSA_pkcs1</tt> class and <tt class="function">getSignatureImpl()</tt> function,
which returns an appropriate subclass of <tt class="class">DigestWithRSA</tt>.

<P>
<dl><dt><b><a name='l2h-33'><tt class='class'>RSA_pkcs1</tt></a></b> (<var>key</var>)
<dd>
The <tt class="class">RSA_pkcs1</tt> class is a wrapper for
<tt class="module">Crypto.PublicKey.RSA</tt> key objects that implements the PKCS #1
standard.  Its encryption and decryption methods handle objects that
are properly padded and encoded for interchange with other PKCS #1
implementations. 

<P>
The constructor accepts either a key object generated by
<tt class="module">Crypto.PublicKey.RSA</tt> or a tuple of key components that can be
used to construct one.

<P>
<tt class="class">RSA_pkcs1</tt> defines the following methods:

<P>
<dl><dt><b><a name='l2h-34'><tt class='method'>getPublicComponents</tt></a></b> ()
<dd>
Returns the public components of the key, <var>e</var> and <var>n</var>.
</dl>

<P>
<dl><dt><b><a name='l2h-35'><tt class='method'>getPrivateComponents</tt></a></b> ()
<dd>
Returns the public components of the key, <var>d</var>, <var>p</var> and <var>q</var>.
</dl>

<P>
<dl><dt><b><a name='l2h-36'><tt class='method'>encryptPublic</tt></a></b> (<var>plain</var>)
<dd>
Returns the plaintext <var>plain</var> encrypted with the public key.
Raises <tt class="exception">ValueError</tt> if the plaintext is too long for the key.
</dl>

<P>
<dl><dt><b><a name='l2h-37'><tt class='method'>decryptPublic</tt></a></b> (<var>cipher</var>)
<dd>
Returns the plaintext obtained by decrypting <var>cipher</var> with the
public key.  Raises <tt class="exception">ValueError</tt> if the ciphertext is too long for the key.
</dl>

<P>
<dl><dt><b><a name='l2h-38'><tt class='method'>encryptPrivate</tt></a></b> (<var>plain</var>)
<dd>
Returns the plaintext <var>plain</var> encrypted with the private key.
Raises <tt class="exception">ValueError</tt> if the plaintext is too long for the key.
</dl>

<P>
<dl><dt><b><a name='l2h-39'><tt class='method'>decryptPrivate</tt></a></b> (<var>cipher</var>)
<dd>
Returns the plaintext obtained by decrypting <var>cipher</var> with the
private key.  Raises <tt class="exception">ValueError</tt> if the ciphertext is too long for the key.
</dl>

<P>
</dl>

<P>
<dl><dt><b><a name='l2h-40'><tt class='class'>DigestWithRSA</tt></a></b> (<var>key</var>)
<dd>
The <tt class="class">DigestWithRSA</tt> is an abstract base class that defines
<tt class="method">sign</tt> and <tt class="method">verify</tt> methods that perform digital
signature operations as defined by PKCS #1.  Subclasses of
<tt class="class">DigestWithRSA</tt> implement a <tt class="method">digest</tt> method that is used
to generate the approriate message digest of the signed object.

<P>
Subclasses must also define two attributes that identify the hash
algorithm: <tt class="member">_digAlgId</tt>, a
<tt class="class">pisces.algid.AlgorithmIdentifier</tt>, and <tt class="member">oid</tt>, a
<tt class="class">pisces.asn1.OID</tt>.

<P>
The constructor takes an <tt class="class">RSA_pkcs1</tt> instance.

<P>
<tt class="class">DigestWithRSA</tt> defines the following methods:

<P>
<dl><dt><b><a name='l2h-41'><tt class='method'>sign</tt></a></b> (<var>data</var>)
<dd>
Returns a string representing the signature of <var>data</var>. Internally,
encrypts a digest of <var>data</var> with the private key. 
</dl>

<P>
<dl><dt><b><a name='l2h-42'><tt class='method'>verify</tt></a></b> (<var>data, sig</var>)
<dd>
Verify that the signature <var>sig</var> matches the original string
<var>data</var>.  Returns 1 if the signature is correct and 0 if it is
not. Raises a <tt class="exception">ValueError</tt> if the hash algorithm used with
the signature does not match the hash algorithm the instance supports.
</dl>

<P>
<dl><dt><b><a name='l2h-43'><tt class='method'>digest</tt></a></b> (<var>data</var>)
<dd>
Returns a digest of <var>data</var> using the hash function defined for the
instance.  Note that this method is defined in subclasses of
<tt class="class">DigestWithRSA</tt>. 
</dl>

<P>
</dl>

<P>
<dl><dt><b><a name='l2h-44'><tt class='class'>MD5withRSA</tt></a></b> (<var>key</var>)
<dd>
A subclass of <tt class="class">DigestWithRSA</tt> that supports the MD5 hash
algorithm. 
</dl>

<P>
<dl><dt><b><a name='l2h-45'><tt class='class'>MD2withRSA</tt></a></b> (<var>key</var>)
<dd>
A subclass of <tt class="class">DigestWithRSA</tt> that supports the MD2 hash
algorithm. 
</dl>

<P>
<dl><dt><b><a name='l2h-46'><tt class='function'>getSignatureImpl</tt></a></b> (<var>algorithmId</var>)
<dd>
Returns a subclass of <tt class="class">DigestWithRSA</tt> that supports the hash
algorithm described by <var>algorithmId</var>, which must be an instance of
<tt class="class">pisces.asn1.OID</tt>.  Currently, MD2 and MD5 are the only
supported hash algorithms.
</dl>

<P>
<p>
<div class='navigation'><hr><table align='center' width='100%' cellpadding='0' cellspacing='2'>
<tr>
<td><A href="module-pisces.pwcrypt.html"><img width=32 height=32 align=bottom border=0 alt="next"
 src="next.gif"></A></td>
<td><A HREF="node8.html"><img width=32 height=32 align=bottom border=0 alt="up"
 src="up.gif"></A></td>
<td><A href="module-pisces.hmac.html"><img width=32 height=32 align=bottom border=0 alt="previous"
 src="previous.gif"></A></td>
<td align=center bgcolor="#99CCFF" width="100%">
 <b class=title>Pisces User Manual</b></td>
<td><A href="contents.html"><img width=32 height=32 align=bottom border=0 alt="contents"
 src="contents.gif"></A></td>
<td><img width=32 height=32 align=bottom border=0 alt=""
 src="blank.gif"></td>
<td><img width=32 height=32 align=bottom border=0 alt=""
 src="blank.gif"></td>
</tr></table><b class='navlabel'>Next:</b> <span class='sectref'><A href="module-pisces.pwcrypt.html">5.7 pisces.pwcrypt - Support</A></span>
<b class='navlabel'>Up:</b> <span class='sectref'><A HREF="node8.html">5. Pisces Library Reference</A></span>
<b class='navlabel'>Previous:</b> <span class='sectref'><A href="module-pisces.hmac.html">5.5 pisces.hmac - Keyed-hashing</A></span>
</div>
<!--End of Navigation Panel-->

</BODY>
</HTML>
